<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>

		<link rel="stylesheet" type="text/css" href="../../css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="../../css/bootstrap-table.min.css" />
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../../js/bootstrap-table.js"></script>
		<script type="text/javascript" src="../../js/bootstrap-table-zh-CN.min.js"></script>
	</head>
	<script>
		$(function() {

			$("#tuijian_tab").bootstrapTable({
				url: 'http://127.0.0.1:8080/tjlist', //请求路径
				method: "post",
				contentType: "application/x-www-form-urlencoded",
				dataType: "json",
				pagination: true, //显示分页栏
				pageNumber: 1, //指定初始的页码
				pageSize: 3, //每页显示的条数
				pageList: [2, 5, 10], //设置每页显示的条数的集合
				sidePagination: "server", //设置服务端分页
				queryParams: queryParam, //设置请求的参数
				queryParamsType: "limit", //设置参数类型，'limit' 

				columns: [{
						field: 'id',
						title: 'ID'
					},
					{
						field: 'course_name',
						title: '课程名称'
					},
					{
						field: 'name',
						title: '推荐分类'
					},
					{
						field: 'order_num',
						title: '排序值'
					},
					{
						field: 'is_avaliable',
						title: '课程状态',
						formatter: function(value, row, index) {
							return value == "1" ? "上架" : "下架";
						}
					},

					{
						title: "操作",
						field: null,
						formatter: function(value, row, index) {
							var del = "<button onclick='deltuijian(" + row.id + ")' class='btn btn-xs btn-danger'>删除</button>";
							
							return del ;
						}

					}
				]
			});

			function queryParam(param) {
				return {
					startrow: param.offset,
					pagesize: param.limit

				}
			};


			
		});
	</script>
		<!------------------------删除的方法-------------------------------------------->
	<script>

			function deltuijian(id){
				alert('删除课程，id为：'+id);
				$.ajax({
					type:'DELETE',
					url:"http:127.0.0.1:8080/deltuijian",
					
					data:{"id":id},
					success:function(msg){
						if(msg=="ok"){
			   				 alert("删除成功");
			   				$("#tuijian_tab").bootstrapTable("refresh","http://127.0.0.1:8080/tjlist");
						} else {
							alert("删除失败")
							return false;
						}
					}
				})
			}
						

	</script>
	<body>

		<!--------------------模糊查询<script></script>------------------------------------>
		<script>
			$(function() {
				$("#searchBtn").click(function() {
					$("#tuijian_tab").bootstrapTable("refresh", "http://127.0.0.1:8080/tjlist");
				});

				$("#resetBtn").click(function() {
					course_name: $("#course_name").val("");
					name: $("#class_id").val("");
					is_avaliable: $("#is_avaliable").val("");
				})

			});
			//模糊查询请求的参数
			function queryParam(param) {
				return {
					//
					course_name: $("#course_name").val(),
					class_id: $("#class_id").val(),
					is_avaliable: $("#is_avaliable").val(),

				};
			}
		</script>
		
			
		<!---------------------模糊查询按钮------------------------------------------------->
		<div class="panel panel-default">

			<!-- 查询条件 -->
			<div class="panel-body form-group" style="margin-bottom: 0px;">
				<!--课程名-->
				<div class="col-sm-2">
					<input type="text" class="form-control" name="ccourse_name" id="course_name" placeholder="课程名" />
				</div>
				<!--分类： -->
				<div class="col-sm-2">
					<select id="class_id" name="class_id" class="form-control">
						<option value="">请选择类型</option>

					</select>
				</div>
				<script>
					$.ajax({
						method: 'get',
						url: 'http://127.0.0.1:8080/lxlist',
						success: function(data) {
							$.each(data, function(index, l) {
								$("#class_id").append("<option value='" + l.id + "'>" + l.name + "</option>");
							})

						}
					})
				</script>
				<!-- 状态： -->
				<div class="col-sm-2">
					<select id="is_avaliable" name="is_avaliable" class="form-control">
						<option value="">请选择状态</option>
						<option value="1">上架</option>
						<option value="2">下架</option>
					</select>
				</div>
				
				
				<button type="button" class="btn btn-primary" id="searchBtn">查找</button>
				<button type="button" class="btn btn-warning" id="resetBtn">清空</button>
				<button type="button" class="btn btn-info" id="addcourseBtn">添加推荐课程</button>
			</div>
		</div>
		<!---------------------点击添加按钮------------------------------------------------->
		<script>
			$(function(){
				$("#addcourseBtn").click(function(){
					/*显示模态框*/
					$("#myModal").modal("show");
					$("#add_tuijian").bootstrapTable(){
						
						
					}
					
					
				})
				
			})
			
			
		</script>


		<!-----------------------------推荐课程-------------------------------->
		<table id="tuijian_tab" border="1"></table>
		<!------------------------------模态框--------------------------------->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
		aria-labelledby="myModalLabel" aria-hidden="true"
		data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				
			<!--表单-->	
				<form method="post" id="addform" action="" enctype="multipart/form-data"  onsubmit="return fun();">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-hidden="true" id="btnCancel">×</button>
						<h4 class="modal-title" id="title" name="title">添加推荐课程</h4>
						
						<table id="add_tuijian"></table>
						
					</div>
					<div class="modal-body">
						
					<input type="hidden" id="addflag">
					<div class="modal-footer" style="border-top: none;">
						<button type="button" class="btn btn-default" data-dismiss="modal"
							id="btnClose">关闭</button>
						<button type="button" class="btn btn-primary" id="btnSave"
							onclick="addshop()">保存</button>
						
					</div>
				</form>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal -->
	</div>

	</body>

</html>